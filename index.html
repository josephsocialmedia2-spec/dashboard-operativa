<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>GESTIONALE ‚Äî Hub Operativo</title>

  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

  <style>
    :root{
      --bg:#0b0f18; --card:#111827; --line:#222; --text:#fff; --muted:#aaa;
      --accent:#d8b34a; --accent2: rgba(216,179,74,.35);
    }
    body{margin:0;font-family:Arial,Helvetica,sans-serif;background:var(--bg);color:var(--text)}
    header{padding:24px;text-align:center;border-bottom:1px solid var(--line)}
    header h1{margin:0;letter-spacing:6px}
    header p{margin-top:8px;color:var(--muted);font-size:14px}

    .wrap{max-width:1100px;margin:0 auto}
    .grid{
      display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
      gap:20px;padding:30px;padding-bottom:120px;
    }
    .card{
      background:var(--card);border:1px solid var(--line);border-radius:14px;
      padding:20px;cursor:pointer;transition:all .2s ease;min-height:120px;
      display:flex;gap:14px;align-items:flex-start;
    }
    .card:hover{
      transform:translateY(-6px);border-color:var(--accent);
      box-shadow:0 0 18px var(--accent2);
    }
    .card i{font-size:26px;color:var(--accent);margin-top:2px}
    .card h3{margin:0 0 6px}
    .card p{margin:0;font-size:14px;color:#bbb;line-height:1.35}
    .card small{display:block;margin-top:8px;color:#7f8aa3;font-size:12px}

    .pillbar{
      display:flex;gap:10px;flex-wrap:wrap;justify-content:center;
      padding:0 18px 18px;
    }
    .pill{
      border:1px solid var(--line);background:rgba(255,255,255,.04);
      border-radius:999px;padding:8px 12px;font-size:12px;color:var(--muted);
      display:flex;gap:8px;align-items:center;
    }

    footer{
      position:fixed;bottom:0;left:0;right:0;background:var(--bg);
      border-top:1px solid var(--line);display:flex;justify-content:space-around;padding:14px 0;
    }
    footer button{
      background:none;border:none;color:var(--muted);font-size:12px;
      display:flex;flex-direction:column;align-items:center;cursor:pointer;
    }
    footer button i{font-size:18px;margin-bottom:4px}
    footer button:hover{color:var(--accent)}

    /* Modal setup */
    .modalBackdrop{
      position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center;
      padding:18px;z-index:50;
    }
    .modal{
      width:min(920px,100%);background:#0f1522;border:1px solid #2a3347;border-radius:16px;
      box-shadow:0 20px 80px rgba(0,0,0,.55);overflow:hidden;
    }
    .modalHeader{
      padding:14px 16px;border-bottom:1px solid #2a3347;display:flex;justify-content:space-between;align-items:center;gap:12px;
    }
    .modalHeader strong{letter-spacing:.4px}
    .modalHeader button{
      background:rgba(255,255,255,.06);border:1px solid #2a3347;color:#fff;border-radius:10px;padding:8px 10px;cursor:pointer;
    }
    .modalBody{padding:16px;display:grid;gap:14px}
    .row{display:grid;grid-template-columns:1fr 2fr;gap:12px}
    @media (max-width:820px){.row{grid-template-columns:1fr}}
    label{font-size:12px;color:#9fb0c3}
    input[type="text"], textarea{
      width:100%;background:rgba(0,0,0,.25);border:1px solid #2a3347;color:#fff;border-radius:12px;padding:10px;outline:none;
    }
    textarea{min-height:80px;resize:vertical}
    .btnRow{display:flex;gap:10px;flex-wrap:wrap;justify-content:flex-end}
    .btn{
      background:rgba(216,179,74,.18);border:1px solid rgba(216,179,74,.5);color:#fff;
      padding:10px 12px;border-radius:12px;cursor:pointer;font-weight:700;font-size:12px;
    }
    .btn.secondary{background:rgba(255,255,255,.06);border:1px solid #2a3347}
    .hint{font-size:12px;color:#9fb0c3;line-height:1.45}
    .sep{height:1px;background:#2a3347;margin:6px 0}

    /* Tools list */
    .toolLine{
      display:grid;grid-template-columns:1.2fr 2fr 44px;gap:10px;align-items:center;
      padding:10px;border:1px solid #2a3347;border-radius:12px;background:rgba(0,0,0,.16);
    }
    .toolLine button{
      width:44px;height:38px;border-radius:10px;border:1px solid #2a3347;background:rgba(255,255,255,.06);
      color:#fff;cursor:pointer;
    }
    .toolLine button:hover{border-color:var(--accent)}
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <h1>GESTIONALE</h1>
      <p>Hub operativo ‚Äî link salvati una volta sola (localStorage) ¬∑ espandibile per clienti / tool / prompt</p>
    </header>

    <div class="pillbar">
      <div class="pill"><i class="fa-solid fa-calendar-day"></i><span id="today"></span></div>
      <div class="pill"><i class="fa-solid fa-phone"></i><span id="contactPill">üìû 371 370 8294</span></div>
      <div class="pill"><i class="fa-solid fa-globe"></i><span>realmediapro.it</span></div>
      <div class="pill"><i class="fa-solid fa-envelope"></i><span>info@realmediapro.it</span></div>
    </div>

    <section class="grid" id="cards"></section>
  </div>

  <footer>
    <button onclick="scrollToTop()"><i class="fa-solid fa-house"></i>Home</button>
    <button onclick="openStats()"><i class="fa-solid fa-chart-line"></i>Stats</button>
    <button onclick="openQuickAdd()"><i class="fa-solid fa-plus-circle"></i>Nuovo</button>
    <button onclick="openTasks()"><i class="fa-solid fa-list-check"></i>Task</button>
    <button onclick="openSetup()"><i class="fa-solid fa-gear"></i>Setup</button>
  </footer>

  <!-- SETUP MODAL -->
  <div class="modalBackdrop" id="setupBackdrop">
    <div class="modal">
      <div class="modalHeader">
        <div>
          <strong>Setup ‚Äî Link e strumenti</strong>
          <div class="hint">Qui inserisci i link UNA VOLTA. Da ora in poi la dashboard li usa automaticamente.</div>
        </div>
        <button onclick="closeSetup()"><i class="fa-solid fa-xmark"></i></button>
      </div>

      <div class="modalBody">
        <div class="row">
          <div>
            <label>Contatti (testo breve)</label>
            <input type="text" id="contactsText" placeholder="üìû 371 370 8294 ¬∑ realmediapro.it ¬∑ info@realmediapro.it" />
            <div class="hint" style="margin-top:8px">
              Questo testo lo puoi riusare come ‚Äúblocco contatti‚Äù rapido nelle caption.
            </div>
          </div>
          <div>
            <label>Blocco contatti esteso (per copia/incolla)</label>
            <textarea id="contactsBlock" placeholder="üìû 371 370 8294&#10;üåê www.realmediapro.it&#10;üìß info@realmediapro.it&#10;üì© DM per info e collaborazioni"></textarea>
          </div>
        </div>

        <div class="sep"></div>

        <div class="hint"><strong>Sezioni principali</strong> (card fisse)</div>

        <div class="row">
          <div>
            <label>Acquisizione</label>
            <input type="text" id="link_acquisizione" placeholder="https://..." />
          </div>
          <div>
            <label>Lead</label>
            <input type="text" id="link_lead" placeholder="https://..." />
          </div>
        </div>

        <div class="row">
          <div>
            <label>Promozione</label>
            <input type="text" id="link_promozione" placeholder="https://..." />
          </div>
          <div>
            <label>Digital Sale</label>
            <input type="text" id="link_digitalsale" placeholder="https://..." />
          </div>
        </div>

        <div class="row">
          <div>
            <label>SOP 01 (dashboard operativa)</label>
            <input type="text" id="link_sop01" placeholder="sop01.html (consigliato) oppure URL completo" />
          </div>
          <div>
            <label>Cartella Prompt / ChatGPT (link)</label>
            <input type="text" id="link_prompts" placeholder="https://chatgpt.com/..." />
          </div>
        </div>

        <div class="sep"></div>

        <div class="hint"><strong>Strumenti extra</strong> (aggiungibili ‚Äî Canva, Meta Business Suite, TikTok Studio, YouTube Studio, ecc.)</div>
        <div id="toolsList" style="display:grid;gap:10px"></div>

        <div class="btnRow">
          <button class="btn secondary" onclick="addTool()">+ Aggiungi tool</button>
          <button class="btn secondary" onclick="exportConfig()">Esporta config (.json)</button>
          <button class="btn secondary" onclick="importConfig()">Importa config</button>
          <button class="btn" onclick="saveConfig()">Salva</button>
        </div>

        <div class="hint">
          Nota: i link vengono salvati sul dispositivo (localStorage). Se vuoi condividerli con altri PC/collaboratori usa ‚ÄúEsporta config‚Äù e poi ‚ÄúImporta‚Äù.
        </div>
      </div>
    </div>
  </div>

<script>
  const CFG_KEY = "gestionale_cfg_v1";

  const DEFAULT_CFG = {
    contactsText: "üìû 371 370 8294 ¬∑ realmediapro.it ¬∑ info@realmediapro.it",
    contactsBlock: "üìû 371 370 8294\nüåê www.realmediapro.it\nüìß info@realmediapro.it\nüì© DM per info e collaborazioni",
    links: {
      acquisizione: "https://josephsocialmedia2-spec.github.io/acquisizione/",
      lead: "https://josephsocialmedia2-spec.github.io/lead/",
      promozione: "https://josephsocialmedia2-spec.github.io/promozione/",
      digitalsale: "https://josephsocialmedia2-spec.github.io/Digital-Sale-Immobiliare/",
      sop01: "sop01.html",
      prompts: ""
    },
    tools: [
      { name: "Canva", url: "https://www.canva.com/" },
      { name: "Meta Business Suite", url: "https://business.facebook.com/" },
      { name: "TikTok Studio", url: "https://www.tiktok.com/creator-center" },
      { name: "YouTube Studio", url: "https://studio.youtube.com/" }
    ]
  };

  function loadCfg(){
    try{
      const raw = localStorage.getItem(CFG_KEY);
      return raw ? JSON.parse(raw) : structuredClone(DEFAULT_CFG);
    }catch(e){
      return structuredClone(DEFAULT_CFG);
    }
  }
  function saveCfg(cfg){
    localStorage.setItem(CFG_KEY, JSON.stringify(cfg));
  }

  function openLink(url){
    if(!url){ alert("Link non impostato. Vai su Setup ‚öôÔ∏è"); return; }
    window.open(url, "_blank", "noopener");
  }
  function scrollToTop(){ window.scrollTo({top:0, behavior:"smooth"}); }

  function renderCards(){
    const cfg = loadCfg();
    document.getElementById("contactPill").textContent = cfg.contactsText || DEFAULT_CFG.contactsText;

    const cardsEl = document.getElementById("cards");
    cardsEl.innerHTML = "";

    const fixed = [
      { key:"acquisizione", icon:"fa-building", title:"Acquisizione", desc:"Gestione acquisizione" },
      { key:"lead", icon:"fa-user-check", title:"Lead", desc:"Gestione contatti" },
      { key:"promozione", icon:"fa-bullhorn", title:"Promozione", desc:"Campagne e visibilit√†" },
      { key:"digitalsale", icon:"fa-handshake", title:"Digital Sale", desc:"Vendita immobiliare" },
      { key:"sop01", icon:"fa-clipboard-check", title:"SOP 01", desc:"Dashboard operativa (checklist + KPI + timer)" },
      { key:"prompts", icon:"fa-wand-magic-sparkles", title:"Prompt", desc:"Prompt ChatGPT per velocizzare lavoro" },
    ];

    fixed.forEach(c => {
      const url = cfg.links[c.key] || "";
      const div = document.createElement("div");
      div.className = "card";
      div.onclick = () => openLink(url);
      div.innerHTML = `
        <i class="fa-solid ${c.icon}"></i>
        <div>
          <h3>${c.title}</h3>
          <p>${c.desc}</p>
          <small>${url ? url : "‚ö†Ô∏è Link non impostato (Setup)"}</small>
        </div>
      `;
      cardsEl.appendChild(div);
    });

    // Tools extra
    cfg.tools.forEach(t => {
      const div = document.createElement("div");
      div.className = "card";
      div.onclick = () => openLink(t.url);
      div.innerHTML = `
        <i class="fa-solid fa-screwdriver-wrench"></i>
        <div>
          <h3>${escapeHtml(t.name || "Tool")}</h3>
          <p>Strumento rapido</p>
          <small>${t.url ? escapeHtml(t.url) : "‚ö†Ô∏è Link non impostato (Setup)"}</small>
        </div>
      `;
      cardsEl.appendChild(div);
    });
  }

  // Setup modal
  const backdrop = document.getElementById("setupBackdrop");
  function openSetup(){ fillSetup(); backdrop.style.display = "flex"; }
  function closeSetup(){ backdrop.style.display = "none"; }

  function fillSetup(){
    const cfg = loadCfg();
    document.getElementById("contactsText").value = cfg.contactsText || "";
    document.getElementById("contactsBlock").value = cfg.contactsBlock || "";

    document.getElementById("link_acquisizione").value = cfg.links.acquisizione || "";
    document.getElementById("link_lead").value = cfg.links.lead || "";
    document.getElementById("link_promozione").value = cfg.links.promozione || "";
    document.getElementById("link_digitalsale").value = cfg.links.digitalsale || "";
    document.getElementById("link_sop01").value = cfg.links.sop01 || "";
    document.getElementById("link_prompts").value = cfg.links.prompts || "";

    renderToolsEditor(cfg.tools || []);
  }

  function renderToolsEditor(tools){
    const list = document.getElementById("toolsList");
    list.innerHTML = "";
    tools.forEach((t, idx) => {
      const line = document.createElement("div");
      line.className = "toolLine";
      line.innerHTML = `
        <input type="text" value="${escapeAttr(t.name || "")}" placeholder="Nome tool (es. Canva)" data-tool-name="${idx}">
        <input type="text" value="${escapeAttr(t.url || "")}" placeholder="Link tool" data-tool-url="${idx}">
        <button title="Rimuovi" onclick="removeTool(${idx})"><i class="fa-solid fa-trash"></i></button>
      `;
      list.appendChild(line);
    });
  }

  function collectToolsFromEditor(){
    const names = [...document.querySelectorAll("input[data-tool-name]")];
    const urls  = [...document.querySelectorAll("input[data-tool-url]")];
    const tools = names.map((n, i) => ({
      name: n.value.trim(),
      url: (urls[i]?.value || "").trim()
    })).filter(t => t.name || t.url);
    return tools;
  }

  function addTool(){
    const cfg = loadCfg();
    cfg.tools = cfg.tools || [];
    cfg.tools.push({name:"", url:""});
    saveCfg(cfg);
    fillSetup();
  }
  function removeTool(idx){
    const cfg = loadCfg();
    cfg.tools = (cfg.tools || []).filter((_, i) => i !== idx);
    saveCfg(cfg);
    fillSetup();
  }

  function saveConfig(){
    const cfg = loadCfg();

    cfg.contactsText = document.getElementById("contactsText").value.trim();
    cfg.contactsBlock = document.getElementById("contactsBlock").value.trim();

    cfg.links.acquisizione = document.getElementById("link_acquisizione").value.trim();
    cfg.links.lead = document.getElementById("link_lead").value.trim();
    cfg.links.promozione = document.getElementById("link_promozione").value.trim();
    cfg.links.digitalsale = document.getElementById("link_digitalsale").value.trim();
    cfg.links.sop01 = document.getElementById("link_sop01").value.trim();
    cfg.links.prompts = document.getElementById("link_prompts").value.trim();

    cfg.tools = collectToolsFromEditor();

    saveCfg(cfg);
    closeSetup();
    renderCards();
    alert("Config salvata ‚úÖ");
  }

  // Export / import config
  function exportConfig(){
    const cfg = loadCfg();
    const blob = new Blob([JSON.stringify(cfg, null, 2)], {type:"application/json;charset=utf-8"});
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "gestionale_config.json";
    a.click();
    URL.revokeObjectURL(url);
  }

  function importConfig(){
    const inp = document.createElement("input");
    inp.type = "file";
    inp.accept = "application/json";
    inp.onchange = () => {
      const file = inp.files?.[0];
      if(!file) return;
      const reader = new FileReader();
      reader.onload = () => {
        try{
          const cfg = JSON.parse(String(reader.result || ""));
          saveCfg(cfg);
          fillSetup();
          renderCards();
          alert("Config importata ‚úÖ");
        }catch(e){
          alert("File non valido.");
        }
      };
      reader.readAsText(file);
    };
    inp.click();
  }

  // Placeholder footer buttons (puoi agganciarci pagine future)
  function openStats(){ alert("Stats: se vuoi, qui possiamo aggiungere un pannello KPI in futuro."); }
  function openQuickAdd(){ alert("Nuovo: qui possiamo aggiungere 'Nuovo cliente / nuovo contenuto / nuovo task'."); }
  function openTasks(){ alert("Task: qui possiamo integrare una checklist globale cross-clienti."); }

  function escapeHtml(s){ return String(s).replace(/[&<>"']/g,m=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"}[m])); }
  function escapeAttr(s){ return escapeHtml(s).replace(/"/g,'&quot;'); }

  // init
  document.getElementById("today").textContent = new Date().toLocaleDateString("it-IT",{weekday:"long",year:"numeric",month:"long",day:"numeric"});
  if(!localStorage.getItem(CFG_KEY)) saveCfg(structuredClone(DEFAULT_CFG));
  renderCards();
</script>
</body>
</html>
